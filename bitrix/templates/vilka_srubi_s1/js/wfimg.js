// https://github.com/alexanderdickson/waitForImages
(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):"object"===typeof exports?module.exports=a(require("jquery")):a(jQuery)})(function(a){a.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage","cursor"],hasImageAttributes:["srcset"]};a.expr[":"]["has-src"]=function(b){return a(b).is('img[src][src!=""]')};a.expr[":"].uncached=function(b){return a(b).is(":has-src")?!b.complete:!1};a.fn.waitForImages=function(){var b=0,k=0,l=a.Deferred(),
    c,d,e;a.isPlainObject(arguments[0])?(e=arguments[0].waitForAll,d=arguments[0].each,c=arguments[0].finished):1===arguments.length&&"boolean"===a.type(arguments[0])?e=arguments[0]:(c=arguments[0],d=arguments[1],e=arguments[2]);c=c||a.noop;d=d||a.noop;e=!!e;if(!a.isFunction(c)||!a.isFunction(d))throw new TypeError("An invalid callback was supplied.");this.each(function(){var h=a(this),f=[],n=a.waitForImages.hasImageProperties||[],p=a.waitForImages.hasImageAttributes||[],q=/url\(\s*(['"]?)(.*?)\1\s*\)/g;
    e?h.find("*").addBack().each(function(){var b=a(this);b.is("img:has-src")&&f.push({src:b.attr("src"),element:b[0]});a.each(n,function(a,c){var g=b.css(c),d;if(!g)return!0;for(;d=q.exec(g);)f.push({src:d[2],element:b[0]})});a.each(p,function(c,d){var g=b.attr(d);if(!g)return!0;g=g.split(",");a.each(g,function(d,c){c=a.trim(c).split(" ")[0];f.push({src:c,element:b[0]})})})}):h.find("img:has-src").each(function(){f.push({src:this.src,element:this})});b=f.length;k=0;0===b&&(c.call(h[0]),l.resolveWith(h[0]));
    a.each(f,function(e,f){var m=new Image;a(m).one("load.waitForImages error.waitForImages",function r(e){e=[k,b,"load"==e.type];k++;d.apply(f.element,e);l.notifyWith(f.element,e);a(this).off("load.waitForImages error.waitForImages",r);if(k==b)return c.call(h[0]),l.resolveWith(h[0]),!1});m.src=f.src})});return l.promise()}});